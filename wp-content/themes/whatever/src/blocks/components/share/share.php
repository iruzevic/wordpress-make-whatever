<?php
/**
 * Template for the Share links Component.
 *
 * @package Whatever\Blocks
 */

$post_id       = $attributes['postId'] ?? '';
$label         = $attributes['label'] ?? '';
$use_facebook  = $attributes['useFacebook'] ?? true;
$use_twitter   = $attributes['useTwitter'] ?? true;
$use_pinterest = $attributes['usePinterest'] ?? true;
$use_linkedin  = $attributes['useLinkedin'] ?? true;
$use_tumblr    = $attributes['useTumblr'] ?? true;

if ( empty( $post_id ) ) {
  return;
}

$component_class = 'share';

$links = [
  [
    'use' => $use_facebook,
    'icon' => '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M3.516 24h7.828v-8.531H8.53v-2.813h2.813V9.141a3.52 3.52 0 013.515-3.516h3.516v2.813h-2.813c-.775 0-1.406.63-1.406 1.406v2.812h4.092l-.469 2.813h-3.623V24h6.328A3.52 3.52 0 0024 20.484V3.516A3.52 3.52 0 0020.484 0H3.516A3.52 3.52 0 000 3.516v16.968A3.52 3.52 0 003.516 24zM1.406 3.516c0-1.163.947-2.11 2.11-2.11h16.968c1.163 0 2.11.947 2.11 2.11v16.968c0 1.163-.947 2.11-2.11 2.11h-4.922v-5.719h3.409l.937-5.625h-4.346V9.844h4.22V4.219h-4.923A4.927 4.927 0 009.938 9.14v2.109H7.124v5.625h2.813v5.719H3.516a2.112 2.112 0 01-2.11-2.11V3.516z" fill="#000" fill-rule="nonzero"/></svg>',
    'link' => "https://www.facebook.com/sharer/sharer.php?u=" . get_permalink( $post_id ),
  ],
  [
    'use' => $use_twitter,
    'icon' => '<svg width="30" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M29.333 3.205c-1.845.085-1.805.078-2.013.096L28.413.18s-3.411 1.254-4.276 1.479c-2.271-2.04-5.647-2.131-8.06-.648-1.977 1.214-3.038 3.3-2.684 5.738-3.846-.534-7.087-2.356-9.646-5.429L2.938.35l-.604 1.11c-.765 1.402-1.019 3.006-.715 4.516.124.619.336 1.21.629 1.763l-.695-.27-.082 1.16c-.083 1.178.309 2.553 1.05 3.678.208.317.477.665.817 1.008l-.359-.055.438 1.329c.576 1.745 1.77 3.096 3.321 3.847-1.548.657-2.8 1.076-4.856 1.752L0 20.807l1.738.95c.663.362 3.004 1.571 5.318 1.934 5.143.807 10.933.15 14.831-3.36 3.283-2.956 4.36-7.16 4.137-11.536-.034-.663.148-1.295.511-1.78a608.95 608.95 0 002.798-3.81zm-4.172 2.78c-.604.806-.906 1.835-.852 2.898.226 4.413-.976 7.836-3.571 10.173-3.032 2.73-7.922 3.8-13.416 2.94-.995-.157-2.023-.506-2.875-.855 1.725-.593 3.056-1.121 5.207-2.139l3.002-1.42-3.315-.212c-1.587-.102-2.91-.871-3.722-2.12a5.947 5.947 0 001.262-.21l3.161-.88-3.187-.78c-1.55-.38-2.432-1.306-2.9-2.017a4.86 4.86 0 01-.629-1.386c.32.086.693.147 1.294.206l2.95.292-2.338-1.823C3.548 7.34 2.873 5.366 3.368 3.47c5.256 5.45 11.428 5.04 12.05 5.185-.137-1.328-.14-1.331-.177-1.457-.795-2.812.948-4.24 1.735-4.723 1.642-1.009 4.25-1.161 6.056.502.39.359.917.5 1.411.377.443-.11.807-.227 1.163-.353l-.741 2.116h.946l-.65.87z" fill="#000" fill-rule="nonzero"/></svg>',
    'link' => "https://twitter.com/home?status=" . get_permalink( $post_id ),
  ],
  [
    'use' => $use_pinterest,
    'icon' => '<svg width="20" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M2.54 13.983l.817.533.308-1.155c.547-2.03.489-1.94.544-2.166-.023-.127-.598-1.652-.197-3.506l.008-.043c.547-3.604 6.597-4.584 9.406-2.24 1.212 1.012 1.668 2.53 1.319 4.39-.251 1.337-.69 2.333-1.378 3.136-.952 1.109-2.149 1.199-2.858.813-.264-.143-.849-.574-.578-1.479.388-1.294 1.089-3.244 1.172-4.657.073-1.26-.689-2.285-1.896-2.551-1.347-.297-2.898.427-3.569 2.117-.483 1.215-.481 2.478.004 3.86.016.34-.332 1.625-.613 2.662-.848 3.135-2.01 7.427-.878 9.613l.357.69.654-.424c1.866-1.21 2.957-4.728 3.554-6.92 1.574 1.16 3.803 1.259 6.008.185 3.54-1.723 5.902-5.836 4.719-10.415C18.124 1.322 13.006-.656 7.85.189 3.6.885.898 3.629.18 7.012c-.606 2.854.343 5.655 2.36 6.971zm-.98-6.68C2.201 4.28 4.638 2.14 8.08 1.576c4.132-.678 8.826.668 9.997 5.2 1.084 4.192-1.299 7.501-3.971 8.802-1.64.798-3.867 1.035-5.204-.695l-.872-1.128-.368 1.376c-.486 1.816-1.27 4.898-2.533 6.546-.247-2.038.674-5.442 1.262-7.613.561-2.074.781-2.936.594-3.461-.38-1.062-.392-2.014-.036-2.91.399-1.004 1.249-1.418 1.953-1.263.254.056.841.275.793 1.097-.071 1.214-.752 3.126-1.115 4.337-.38 1.272.111 2.495 1.254 3.116 1.284.697 3.212.487 4.604-1.134.856-.998 1.394-2.202 1.693-3.79.23-1.228.176-2.357-.163-3.357a5.245 5.245 0 00-1.636-2.37C10.693 1.29 3.369 2.686 2.629 7.414c-.264 1.236-.22 2.522.128 3.827-.056.244-.136.558-.22.88-.981-1.15-1.371-2.958-.977-4.818z" fill="#000" fill-rule="nonzero"/></svg>',
    'link' => "http://pinterest.com/pin/create/button/?url=" . get_permalink( $post_id ),
  ],
  [
    'use' => $use_linkedin,
    'icon' => '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><g fill="#000" fill-rule="nonzero"><path d="M20.484 0H3.516A3.52 3.52 0 000 3.516v16.968A3.52 3.52 0 003.516 24h16.968A3.52 3.52 0 0024 20.484V3.516A3.52 3.52 0 0020.484 0zm2.11 20.484c0 1.163-.947 2.11-2.11 2.11H3.516a2.112 2.112 0 01-2.11-2.11V3.516c0-1.163.947-2.11 2.11-2.11h16.968c1.163 0 2.11.947 2.11 2.11v16.968z"/><path d="M4.249 19.751h4.249v-9.99h-4.25v9.99zm1.416-8.576h1.416v7.162H5.665v-7.162zM15.523 9.76h-.004c-.488 0-.963.082-1.411.241v-.24H9.876v9.99h4.232V14.71c0-.39.317-.707.705-.707.39 0 .706.317.706.707v5.042h4.232v-5.528c0-2.288-1.852-4.46-4.228-4.462zm2.817 8.577h-1.41V14.71c0-1.17-.95-2.12-2.117-2.12a2.12 2.12 0 00-2.116 2.12v3.628h-1.41v-7.162h1.41v1.414l1.13-.85a2.793 2.793 0 011.692-.564h.003c1.501.001 2.818 1.425 2.818 3.048v4.114zM4.249 8.498h4.249v-4.25h-4.25v4.25zm1.416-2.833h1.416v1.416H5.665V5.665z"/></g></svg>',
    'link' => "http://www.linkedin.com/shareArticle?mini=true&url=" . get_permalink( $post_id ),
  ],
  [
    'use' => $use_tumblr,
    'icon' => '<svg width="16" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M4.228 0V2.112A3.524 3.524 0 01.705 5.625H0v5.625h2.819v5.016c0 4.264 3.477 7.734 7.75 7.734h4.933v-7.031H10.57a.705.705 0 01-.705-.703V11.25h5.637V5.625H9.865V0H4.228zm9.865 7.031v2.813H8.456v6.422c0 1.163.948 2.109 2.114 2.109h3.523v4.219H10.57c-3.497 0-6.342-2.84-6.342-6.328V9.844H1.409V6.98a4.922 4.922 0 002.583-1.205l.001.002a4.919 4.919 0 001.644-3.669v-.703h2.819v5.625h5.637z" fill="#000" fill-rule="nonzero"/></svg>',
    'link' => "http://www.tumblr.com/share?v=3&u=" . get_permalink( $post_id ),
  ],
]

?>

<div class="<?php echo esc_attr( $component_class ); ?>">

  <?php if ( ! empty( $label ) ) { ?>
    <div class="<?php echo esc_attr( "{$component_class}__label" ); ?>">
      <?php echo esc_html( $label ); ?>
    </div>
  <?php } ?>

  <ul class="<?php echo esc_attr( "{$component_class}__list" ); ?>">
    <?php foreach( $links as $link ) { ?>
      <?php
        $use  = $link['use'] ?? true;
        $icon = $link['icon'] ?? '';
        $link = $link['link'] ?? '';
      ?>

      <?php if ( $use ) { ?>
        <li class="<?php echo esc_attr( "{$component_class}__item" ); ?>">
          <a target="_blank" rel="noopener noreferrer" href="<?php echo esc_url( $link ); ?>" class="<?php echo esc_attr( "{$component_class}__link" ); ?>">
            <?php
              echo wp_kses( $icon, [
                'svg' => [
                  'xmlns'       => true,
                  'xmlns:xlink' => true,
                  'height'      => true,
                  'width'       => true,
                  'class'       => true,
                ],
                'defs' => true,
                'path' => [
                  'class'     => true,
                  'd'         => true,
                  'fill'      => true,
                  'fill-rule' => true,
                ],
                'circle' => [
                  'id'      => true,
                  'cx'      => true,
                  'cy'      => true,
                  'r'       => true,
                  'opacity' => true,
                ],
                'g' => [
                  'transform' => true,
                  'fill'      => true,
                  'fill-rule' => true,
                ],
                'filter' => [
                  'id' => true,
                  'width'      => true,
                  'height' => true,
                  'x' => true,
                  'y' => true,
                  'filterUnits' => true,
                ],
                'feOffset' => [
                  'dy'     => true,
                  'in'     => true,
                  'result' => true,
                ],
                'feGaussianBlur' => [
                  'stdDeviation' => true,
                  'in'           => true,
                  'result'       => true,
                ],
                'feColorMatrix' => [
                  'values'  => true,
                  'in'      => true,
                ],
                'use' => [
                  'fill'       => true,
                  'filter'     => true,
                  'xlink:href' => true,
                ],
              ] );
            ?>
          </a>
        </li>
      <?php } ?>
    <?php } ?>

  </ul>
</div>
